use crate::utils::{FileUpdater, Version, update_text_region_fn};
use std::fmt::Write;

static CARGO_TOML_FILES: &[&str] = &[
    "clippy_config/Cargo.toml",
    "clippy_lints/Cargo.toml",
    "clippy_utils/Cargo.toml",
    "Cargo.toml",
];

pub fn bump_version(mut version: Version) {
    version.minor += 1;

    let mut updater = FileUpdater::default();
    for file in CARGO_TOML_FILES {
        updater.update_file(
            file,
            &mut update_text_region_fn(
                "# begin autogenerated version\n",
                "# end autogenerated version",
                |dst| {
                    writeln!(dst, "version = \"{}\"", version.toml_display()).unwrap();
                },
            ),
        );
    }
}
